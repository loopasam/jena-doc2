#{extends 'main.html' /}
#{set title:'Map' /}

<div id="map-canvas"></div>

<script type="text/javascript">
$(document).ready(function() {

    $.getJSON('/geocoordinates.json', function(data) {
          var latitude = data.results.bindings[0]["latitude"].value;
          var longitude = data.results.bindings[0]["longitude"].value;
          
          var map;
          var mapOptions = {
                        zoom: 9,
                        center: new google.maps.LatLng(latitude, longitude),
                        mapTypeId: google.maps.MapTypeId.ROADMAP
           };
           map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
           
         for(i in data.results.bindings) {
         
              var p = data.head.vars[i];
              var latitude = data.results.bindings[i]["latitude"].value;
              var longitude = data.results.bindings[i]["longitude"].value;
              addMarker(new google.maps.LatLng(latitude, longitude), map);
              console.log(latitude + "-" + longitude);
          }
          
          
    });
    
    function addMarker(location, map) {
        marker = new google.maps.Marker({
            position: location,
            map: map
        });
    }
    
});
</script>
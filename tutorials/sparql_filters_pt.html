<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<!--

    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE- 2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->

  <title>Apache Jena - Tutorial SPARQL – Filtros</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link href="/jena-doc2/css/bootstrap.css" rel="stylesheet" media="screen">
  <link href="/jena-doc2/css/bootstrap-extension.css" rel="stylesheet" type="text/css">
  
  <script src="http://code.jquery.com/jquery-2.0.3.min.js"></script>
  <script src="/jena-doc2/js/jena-navigation.js" type="text/javascript"></script>
  <script src="/jena-doc2/js/bootstrap.min.js" type="text/javascript"></script>
  <script src="/jena-doc2/js/breadcrumbs.js" type="text/javascript"></script>
</head>

<body>



<nav class="navbar navbar-default" role="navigation">
<div class="container">
  <div class="navbar-header">
 	<a class="navbar-brand" href="/jena-doc2/index.html">
		<img class="logo-menu" src="/jena-doc2/images/jena-logo/jena-logo-notext-small.png" alt="jena logo">Apache Jena</a>
  </div>
  
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>


  <div class="collapse navbar-collapse navbar-ex1-collapse">
    <ul class="nav navbar-nav">



              <li id="homepage"><a href="/jena-doc2/index.html"><span class="glyphicon glyphicon-home"></span> Home</a></li>
              <li id="download"><a href="/jena-doc2/download/index.html"><span class="glyphicon glyphicon-download-alt"></span> Download</a></li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown"><span class="glyphicon glyphicon-book"></span> Learn <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li class="dropdown-header">Tutorials</li>
                  <li><a href="/jena-doc2/tutorials/index.html">Overview</a></li>
                  <li><a href="/jena-doc2/tutorials/rdf_api.html">RDF core API tutorial</a></li>
                  <li><a href="/jena-doc2/tutorials/sparql.html">SPARQL tutorial</a></li>
                  <li><a href="/jena-doc2/documentation/query/manipulating_sparql_using_arq.html">Manipulating SPARQL using ARQ</a></li>
                  <li><a href="/jena-doc2/tutorials/using_jena_with_eclipse.html">Using Jena with Eclipse</a></li>
                  <li><a href="/jena-doc2/documentation/notes/index.html">How-To's</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">References</li>
                  <li><a href="/jena-doc2/documentation/index.html">Overview</a></li>
                  <li><a href="/jena-doc2/documentation/javadoc/">Javadoc</a></li>
                  <li><a href="/jena-doc2/documentation/rdf/index.html">RDF API</a></li>
                  <li><a href="/jena-doc2/documentation/io/">RDF I/O</a></li>
                  <li><a href="/jena-doc2/documentation/query/index.html">ARQ (SPARQL)</a></li>
                  <li><a href="/jena-doc2/documentation/query/text-query.html">Text Search</a></li>
                  <li><a href="/jena-doc2/documentation/tdb/index.html">TDB</a></li>
                  <li><a href="/jena-doc2/documentation/sdb/index.html">SDB</a></li>
                  <li><a href="/jena-doc2/documentation/serving_data/index.html">Fuseki</a></li>
                  <li><a href="/jena-doc2/documentation/assembler/index.html">Assembler</a></li>
                  <li><a href="/jena-doc2/documentation/ontology/">Ontology API</a></li>
                  <li><a href="/jena-doc2/documentation/inference/index.html">Inference API</a></li>
                  <li><a href="/jena-doc2/documentation/tools/index.html">Command-line tools</a></li>
                </ul>
              </li>
              <li id="ask"><a href="/jena-doc2/help_and_support/index.html"><span class="glyphicon glyphicon-question-sign"></span> Ask</a></li>
              
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown"><span class="glyphicon glyphicon-bullhorn"></span> Get involved <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li><a href="/jena-doc2/getting_involved/index.html">Contribute</a></li>
                  <li><a href="/jena-doc2/help_and_support/bugs_and_suggestions.html">Report a bug</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Project</li>
                  <li><a href="/jena-doc2/about_jena/about.html">About Jena</a></li>
                  <li><a href="/jena-doc2/about_jena/roadmap.html">Roadmap</a></li>
                  <li><a href="/jena-doc2/about_jena/architecture.html">Architecture</a></li>
                  <li><a href="/jena-doc2/about_jena/team.html">Project team</a></li>
                  <li><a href="/jena-doc2/about_jena/contributions.html">Related projects</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">ASF</li>
                  <li><a href="http://www.apache.org/">Apache Software Foundation</a></li>
                  <li><a href="http://www.apache.org/licenses/LICENSE-2.0">License</a></li>
                  <li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
                  <li><a href="http://www.apache.org/foundation/sponsorship.html">Become a Sponsor</a></li>
                  <li><a href="http://www.apache.org/security/">Security</a></li>
                </ul>
              </li>

   
    </ul>
  </div>
</div>
</nav>


<div class="container">
	<div class="row">
	<div class="col-md-12">
	<div id="breadcrumbs"></div>
	<h1 class="title">Tutorial SPARQL – Filtros</h1>
  <p>Casamento em Grafos permite que sejam encontrados padrões no grafo. Essa seção descreve como os valores numa solução podem ser restritas. Há muitas comparações disponíveis – vamos apenas cobrir dois casos destes.</p>
<h2 id="casamento-de-strings">Casamento de Strings</h2>
<p>SPARQL fornece uma operação para testar strings, baseada em expressões regulares. Isso inclui a habilidade de testes como SQL "LIKE", no entanto, a sintaxe de expressões regulares é diferente de SQL.</p>
<p>A sintaxe é:</p>
<div class="codehilite"><pre><span class="n">FILTER</span> <span class="n">regex</span><span class="p">(</span><span class="o">?</span><span class="n">x</span><span class="p">,</span> <span class="s">&quot;pattern&quot;</span> <span class="p">[,</span> <span class="s">&quot;flags&quot;</span><span class="p">])</span>
</pre></div>


<p>O argumento flags é opcional. A flag "i" significa casamento de padrão case-insensitivo.</p>
<p>A consulta (<a href="sparql_data/q-f1.rq">q-f1.rq</a>) procura nomes com um “r” ou “R” neles.</p>
<div class="codehilite"><pre><span class="n">PREFIX</span> <span class="n">vcard</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">http</span><span class="o">:</span><span class="c1">//www.w3.org/2001/vcard-rdf/3.0#&gt;</span>

<span class="n">SELECT</span> <span class="o">?</span><span class="n">g</span>
<span class="n">WHERE</span>
<span class="p">{</span> <span class="o">?</span><span class="n">y</span> <span class="n">vcard</span><span class="o">:</span><span class="n">Given</span> <span class="o">?</span><span class="n">g</span> <span class="p">.</span>
  <span class="n">FILTER</span> <span class="n">regex</span><span class="p">(</span><span class="o">?</span><span class="n">g</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">,</span> <span class="s">&quot;i&quot;</span><span class="p">)</span> <span class="p">}</span>
</pre></div>


<p>resultados:</p>
<div class="codehilite"><pre><span class="o">-------------</span>
<span class="o">|</span> <span class="n">g</span>         <span class="o">|</span>
<span class="o">=============</span>
<span class="o">|</span> <span class="s">&quot;Rebecca&quot;</span> <span class="o">|</span>
<span class="o">|</span> <span class="s">&quot;Sarah&quot;</span>   <span class="o">|</span>
<span class="o">-------------</span>
</pre></div>


<p>A linguagem de expressão regular 
<a href="http://www.w3.org/TR/xpath-functions/#regex-syntax">XQuery regular expression language</a>
é a versão codificada da mesma encontrada em Perl.</p>
<h2 id="testando-valores">Testando valores</h2>
<p>Muitas vezes, a aplicação necessita filtrar com o valor de uma variável. No arquivo <a href="sparql_data/vc-db-2.rdf">vc-db-2.rdf</a>, nós adicionamos um campo extra para idade. Idade não é definida no esquema de vcard então tivemos que criar uma nova propriedade para usar neste tutorial. RDF permite a mistura de diferentes definições de informação porque URIs são únicas. Note também que a propriedade info:age é tipada.</p>
<p>Nesse pedaço de dado, nós mostramos o valor tipado.</p>
<div class="codehilite"><pre><span class="o">&lt;</span><span class="n">http</span><span class="o">:</span><span class="c1">//somewhere/RebeccaSmith/&gt;</span>
    <span class="nl">info:</span><span class="n">age</span> <span class="s">&quot;23&quot;</span><span class="o">^^</span><span class="n">xsd</span><span class="o">:</span><span class="n">integer</span> <span class="p">;</span>
    <span class="nl">vCard:</span><span class="n">FN</span> <span class="s">&quot;Becky Smith&quot;</span> <span class="p">;</span>
    <span class="nl">vCard:</span><span class="n">N</span> <span class="p">[</span> <span class="n">vCard</span><span class="o">:</span><span class="n">Family</span> <span class="s">&quot;Smith&quot;</span> <span class="p">;</span>
              <span class="nl">vCard:</span><span class="n">Given</span>  <span class="s">&quot;Rebecca&quot;</span> <span class="p">]</span> <span class="p">.</span>
</pre></div>


<p>Então a consulta (<a href="sparql_data/q-f2.rq">q-f2.rq</a>) para procurar as pessoas mais velhas que 24 anos é:</p>
<div class="codehilite"><pre><span class="n">PREFIX</span> <span class="n">info</span><span class="o">:</span> <span class="o">&lt;</span><span class="n">http</span><span class="o">:</span><span class="c1">//somewhere/peopleInfo#&gt;</span>

<span class="n">SELECT</span> <span class="o">?</span><span class="n">resource</span>
<span class="n">WHERE</span>
  <span class="p">{</span>
    <span class="o">?</span><span class="n">resource</span> <span class="n">info</span><span class="o">:</span><span class="n">age</span> <span class="o">?</span><span class="n">age</span> <span class="p">.</span>
    <span class="n">FILTER</span> <span class="p">(</span><span class="o">?</span><span class="n">age</span> <span class="o">&gt;=</span> <span class="mi">24</span><span class="p">)</span>
  <span class="p">}</span>
</pre></div>


<p>A expressão aritmética precisa estar em parêntesis. A única solução é:</p>
<div class="codehilite"><pre><span class="o">---------------------------------</span>
<span class="o">|</span> <span class="n">resource</span>                      <span class="o">|</span>
<span class="o">=================================</span>
<span class="o">|</span> <span class="o">&lt;</span><span class="n">http</span><span class="o">:</span><span class="c1">//somewhere/JohnSmith/&gt; |</span>
<span class="o">---------------------------------</span>
</pre></div>


<p>Apenas um resultado, resultando na URI para o recurso Jonh Smith. Se consultássemos os mais novos que 24 anos, resultaria em Rebecca Smith. Nada sobre os Jones.</p>
<p>O banco de dados não contém informação sobre a idade dos Jones: não há propriedades info:age nos seus vcards, então a variável <code>age</code> não recebe um valor, então não é testada. </p>
<p><a href="sparql_optionals_pt.html">Próximo: Opcionais</a></p>
  </div>
</div>

</div><!--/.container -->

    <footer class="footer">
      <div class="container">
        <p>Copyright &copy; 2011&ndash;2013 The Apache Software Foundation, Licensed under
        the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.
        </p>
        <p>
        Apache Jena, Jena, the Apache Jena project logo,
        Apache and the Apache feather logos are trademarks of The Apache Software Foundation.
        </p>
      </div>
  </footer>
      

</body>
</html>
